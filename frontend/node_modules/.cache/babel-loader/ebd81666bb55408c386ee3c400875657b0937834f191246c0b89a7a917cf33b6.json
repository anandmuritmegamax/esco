{"ast":null,"code":"import { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\";\nimport { setIsAuthenticated, setLoading, setUser } from \"../features/userSlice\";\nexport const userApi = createApi({\n  reducerPath: \"userApi\",\n  baseQuery: fetchBaseQuery({\n    baseUrl: \"/api/v1\"\n  }),\n  tagTypes: [\"User\"],\n  endpoints: builder => ({\n    getMe: builder.query({\n      query: () => `/me`,\n      transformResponse: result => result.user,\n      async onQueryStarted(args, {\n        dispatch,\n        queryFulfilled\n      }) {\n        try {\n          const {\n            data\n          } = await queryFulfilled;\n          dispatch(setUser(data));\n          dispatch(setIsAuthenticated(true));\n          dispatch(setLoading(false));\n        } catch (error) {\n          dispatch(setLoading(false));\n          console.log(error);\n        }\n      },\n      providesTags: ['User']\n    }),\n    updateProfile: builder.mutation({\n      query(body) {\n        return {\n          url: \"/me/update\",\n          method: \"PUT\",\n          body\n        };\n      },\n      invalidatesTags: ['User']\n    }),\n    uploadAvatar: builder.mutation({\n      query(body) {\n        return {\n          url: \"/me/upload_avatar\",\n          method: \"PUT\",\n          body\n        };\n      },\n      invalidatesTags: ['User']\n    }),\n    updatePassword: builder.mutation({\n      query(body) {\n        return {\n          url: \"/password/update\",\n          method: \"PUT\",\n          body\n        };\n      }\n    }),\n    forgotPassword: builder.mutation({\n      query(body) {\n        return {\n          url: \"/password/forgot\",\n          method: \"POST\",\n          body\n        };\n      }\n    }),\n    resetPassword: builder.mutation({\n      query({\n        token,\n        body\n      }) {\n        return {\n          url: `/password/reset/${token}`,\n          method: \"PUT\",\n          body\n        };\n      }\n    })\n  })\n});\nexport const {\n  useGetMeQuery,\n  useUpdateProfileMutation,\n  useUploadAvatarMutation,\n  useUpdatePasswordMutation,\n  useForgotPasswordMutation\n} = userApi;","map":{"version":3,"names":["createApi","fetchBaseQuery","setIsAuthenticated","setLoading","setUser","userApi","reducerPath","baseQuery","baseUrl","tagTypes","endpoints","builder","getMe","query","transformResponse","result","user","onQueryStarted","args","dispatch","queryFulfilled","data","error","console","log","providesTags","updateProfile","mutation","body","url","method","invalidatesTags","uploadAvatar","updatePassword","forgotPassword","resetPassword","token","useGetMeQuery","useUpdateProfileMutation","useUploadAvatarMutation","useUpdatePasswordMutation","useForgotPasswordMutation"],"sources":["/var/www/aayoApp/frontend/src/redux/api/userApi.js"],"sourcesContent":["import { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\"\nimport { setIsAuthenticated, setLoading, setUser } from \"../features/userSlice\";\n\nexport const userApi = createApi({\n    reducerPath: \"userApi\",\n    baseQuery: fetchBaseQuery({\n        baseUrl: \"/api/v1\"\n    }),\n    tagTypes: [\"User\"],\n    endpoints: (builder) => ({\n        getMe: builder.query({\n            query: () => `/me`,\n            transformResponse: (result) => result.user,\n            async onQueryStarted(args, { dispatch, queryFulfilled }) {\n                try {\n                    const { data } = await queryFulfilled;\n                    dispatch(setUser(data));\n                    dispatch(setIsAuthenticated(true));\n                    dispatch(setLoading(false));\n                } catch (error) {\n                    dispatch(setLoading(false));\n                    console.log(error)\n                }\n            },\n            providesTags: ['User'],\n        }),\n        updateProfile: builder.mutation({\n            query(body) {\n                return {\n                    url: \"/me/update\",\n                    method: \"PUT\",\n                    body,\n                }\n            },\n            invalidatesTags: ['User'],\n        }),\n        uploadAvatar: builder.mutation({\n            query(body) {\n                return {\n                    url: \"/me/upload_avatar\",\n                    method: \"PUT\",\n                    body,\n                }\n            },\n            invalidatesTags: ['User'],\n        }),\n        updatePassword: builder.mutation({\n            query(body) {\n                return {\n                    url: \"/password/update\",\n                    method: \"PUT\",\n                    body,\n                }\n            },\n        }),\n        forgotPassword: builder.mutation({\n            query(body) {\n                return {\n                    url: \"/password/forgot\",\n                    method: \"POST\",\n                    body,\n                }\n            },\n        }),\n        resetPassword: builder.mutation({\n            query({ token, body }) {\n                return {\n                    url: `/password/reset/${token}`,\n                    method: \"PUT\",\n                    body,\n                }\n            },\n        }),\n    })\n})\n\nexport const { useGetMeQuery, useUpdateProfileMutation, useUploadAvatarMutation, useUpdatePasswordMutation, useForgotPasswordMutation } = userApi;"],"mappings":"AAAA,SAASA,SAAS,EAAEC,cAAc,QAAQ,8BAA8B;AACxE,SAASC,kBAAkB,EAAEC,UAAU,EAAEC,OAAO,QAAQ,uBAAuB;AAE/E,OAAO,MAAMC,OAAO,GAAGL,SAAS,CAAC;EAC7BM,WAAW,EAAE,SAAS;EACtBC,SAAS,EAAEN,cAAc,CAAC;IACtBO,OAAO,EAAE;EACb,CAAC,CAAC;EACFC,QAAQ,EAAE,CAAC,MAAM,CAAC;EAClBC,SAAS,EAAGC,OAAO,KAAM;IACrBC,KAAK,EAAED,OAAO,CAACE,KAAK,CAAC;MACjBA,KAAK,EAAEA,CAAA,KAAM,KAAK;MAClBC,iBAAiB,EAAGC,MAAM,IAAKA,MAAM,CAACC,IAAI;MAC1C,MAAMC,cAAcA,CAACC,IAAI,EAAE;QAAEC,QAAQ;QAAEC;MAAe,CAAC,EAAE;QACrD,IAAI;UACA,MAAM;YAAEC;UAAK,CAAC,GAAG,MAAMD,cAAc;UACrCD,QAAQ,CAACf,OAAO,CAACiB,IAAI,CAAC,CAAC;UACvBF,QAAQ,CAACjB,kBAAkB,CAAC,IAAI,CAAC,CAAC;UAClCiB,QAAQ,CAAChB,UAAU,CAAC,KAAK,CAAC,CAAC;QAC/B,CAAC,CAAC,OAAOmB,KAAK,EAAE;UACZH,QAAQ,CAAChB,UAAU,CAAC,KAAK,CAAC,CAAC;UAC3BoB,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;QACtB;MACJ,CAAC;MACDG,YAAY,EAAE,CAAC,MAAM;IACzB,CAAC,CAAC;IACFC,aAAa,EAAEf,OAAO,CAACgB,QAAQ,CAAC;MAC5Bd,KAAKA,CAACe,IAAI,EAAE;QACR,OAAO;UACHC,GAAG,EAAE,YAAY;UACjBC,MAAM,EAAE,KAAK;UACbF;QACJ,CAAC;MACL,CAAC;MACDG,eAAe,EAAE,CAAC,MAAM;IAC5B,CAAC,CAAC;IACFC,YAAY,EAAErB,OAAO,CAACgB,QAAQ,CAAC;MAC3Bd,KAAKA,CAACe,IAAI,EAAE;QACR,OAAO;UACHC,GAAG,EAAE,mBAAmB;UACxBC,MAAM,EAAE,KAAK;UACbF;QACJ,CAAC;MACL,CAAC;MACDG,eAAe,EAAE,CAAC,MAAM;IAC5B,CAAC,CAAC;IACFE,cAAc,EAAEtB,OAAO,CAACgB,QAAQ,CAAC;MAC7Bd,KAAKA,CAACe,IAAI,EAAE;QACR,OAAO;UACHC,GAAG,EAAE,kBAAkB;UACvBC,MAAM,EAAE,KAAK;UACbF;QACJ,CAAC;MACL;IACJ,CAAC,CAAC;IACFM,cAAc,EAAEvB,OAAO,CAACgB,QAAQ,CAAC;MAC7Bd,KAAKA,CAACe,IAAI,EAAE;QACR,OAAO;UACHC,GAAG,EAAE,kBAAkB;UACvBC,MAAM,EAAE,MAAM;UACdF;QACJ,CAAC;MACL;IACJ,CAAC,CAAC;IACFO,aAAa,EAAExB,OAAO,CAACgB,QAAQ,CAAC;MAC5Bd,KAAKA,CAAC;QAAEuB,KAAK;QAAER;MAAK,CAAC,EAAE;QACnB,OAAO;UACHC,GAAG,EAAE,mBAAmBO,KAAK,EAAE;UAC/BN,MAAM,EAAE,KAAK;UACbF;QACJ,CAAC;MACL;IACJ,CAAC;EACL,CAAC;AACL,CAAC,CAAC;AAEF,OAAO,MAAM;EAAES,aAAa;EAAEC,wBAAwB;EAAEC,uBAAuB;EAAEC,yBAAyB;EAAEC;AAA0B,CAAC,GAAGpC,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}