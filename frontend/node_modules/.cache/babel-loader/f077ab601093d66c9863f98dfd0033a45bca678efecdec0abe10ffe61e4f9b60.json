{"ast":null,"code":"var _jsxFileName = \"/var/www/aayoS/frontend/src/components/AuthWrapper.jsx\",\n  _s = $RefreshSig$();\n// AuthWrapper.jsx (updated)\nimport { useGetProfileQuery } from \"../redux/api/authApi\"; // Keep as is, but we handle isLoading now\nimport { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { logout } from \"../redux/slices/authSlice\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthWrapper = ({\n  children\n}) => {\n  _s();\n  const token = localStorage.getItem(\"token\"); // Consistent with your storage key\n  const {\n    data,\n    isLoading,\n    isError\n  } = useGetProfileQuery(undefined, {\n    skip: !token // Skip fetch if no token\n  });\n  const dispatch = useDispatch();\n  const {\n    loading: authLoading\n  } = useSelector(state => state.auth); // Use global loading if needed, but isLoading from query is sufficient\n\n  useEffect(() => {\n    if (isError) {\n      dispatch(logout());\n      localStorage.removeItem(\"token\"); // Clean up invalid token\n    }\n  }, [isError, dispatch]);\n\n  // Handle loading: Render a loader until query resolves (prevents race condition)\n  if (isLoading || authLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading authentication...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 12\n    }, this); // Replace with your actual loader/spinner component\n  }\n  return children;\n};\n_s(AuthWrapper, \"9XvJxnvgSH6UywgMxtPl1M7eG04=\", false, function () {\n  return [useGetProfileQuery, useDispatch, useSelector];\n});\n_c = AuthWrapper;\nexport default AuthWrapper;\nvar _c;\n$RefreshReg$(_c, \"AuthWrapper\");","map":{"version":3,"names":["useGetProfileQuery","useEffect","useDispatch","useSelector","logout","jsxDEV","_jsxDEV","AuthWrapper","children","_s","token","localStorage","getItem","data","isLoading","isError","undefined","skip","dispatch","loading","authLoading","state","auth","removeItem","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/var/www/aayoS/frontend/src/components/AuthWrapper.jsx"],"sourcesContent":["// AuthWrapper.jsx (updated)\nimport { useGetProfileQuery } from \"../redux/api/authApi\"; // Keep as is, but we handle isLoading now\nimport { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { logout } from \"../redux/slices/authSlice\";\n\nconst AuthWrapper = ({ children }) => {\n  const token = localStorage.getItem(\"token\"); // Consistent with your storage key\n  const { data, isLoading, isError } = useGetProfileQuery(undefined, {\n    skip: !token, // Skip fetch if no token\n  });\n  const dispatch = useDispatch();\n  const { loading: authLoading } = useSelector((state) => state.auth); // Use global loading if needed, but isLoading from query is sufficient\n\n  useEffect(() => {\n    if (isError) {\n      dispatch(logout());\n      localStorage.removeItem(\"token\"); // Clean up invalid token\n    }\n  }, [isError, dispatch]);\n\n  // Handle loading: Render a loader until query resolves (prevents race condition)\n  if (isLoading || authLoading) {\n    return <div>Loading authentication...</div>; // Replace with your actual loader/spinner component\n  }\n\n  return children;\n};\n\nexport default AuthWrapper;\n"],"mappings":";;AAAA;AACA,SAASA,kBAAkB,QAAQ,sBAAsB,CAAC,CAAC;AAC3D,SAASC,SAAS,QAAQ,OAAO;AACjC,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,SAASC,MAAM,QAAQ,2BAA2B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEnD,MAAMC,WAAW,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EACpC,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;EAC7C,MAAM;IAAEC,IAAI;IAAEC,SAAS;IAAEC;EAAQ,CAAC,GAAGf,kBAAkB,CAACgB,SAAS,EAAE;IACjEC,IAAI,EAAE,CAACP,KAAK,CAAE;EAChB,CAAC,CAAC;EACF,MAAMQ,QAAQ,GAAGhB,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAEiB,OAAO,EAAEC;EAAY,CAAC,GAAGjB,WAAW,CAAEkB,KAAK,IAAKA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC;;EAErErB,SAAS,CAAC,MAAM;IACd,IAAIc,OAAO,EAAE;MACXG,QAAQ,CAACd,MAAM,CAAC,CAAC,CAAC;MAClBO,YAAY,CAACY,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC;IACpC;EACF,CAAC,EAAE,CAACR,OAAO,EAAEG,QAAQ,CAAC,CAAC;;EAEvB;EACA,IAAIJ,SAAS,IAAIM,WAAW,EAAE;IAC5B,oBAAOd,OAAA;MAAAE,QAAA,EAAK;IAAyB;MAAAgB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,CAAC,CAAC;EAC/C;EAEA,OAAOnB,QAAQ;AACjB,CAAC;AAACC,EAAA,CArBIF,WAAW;EAAA,QAEsBP,kBAAkB,EAGtCE,WAAW,EACKC,WAAW;AAAA;AAAAyB,EAAA,GANxCrB,WAAW;AAuBjB,eAAeA,WAAW;AAAC,IAAAqB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}